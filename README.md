# üõ°Ô∏è Anti-Fraud Service API

–ú–∏–∫—Ä–æ—Å–µ—Ä–≤–∏—Å –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏ –∫–ª–∏–µ–Ω—Ç–æ–≤ –Ω–∞ –º–æ—à–µ–Ω–Ω–∏—á–µ—Å—Ç–≤–æ —Å –∫—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ–º –≤ Redis –∏ –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–æ–º —á–µ—Ä–µ–∑ Prometheus+Grafana.

## üöÄ –ë—ã—Å—Ç—Ä—ã–π —Å—Ç–∞—Ä—Ç

```bash
# 1. –ó–∞–ø—É—Å–∫ –≤—Å–µ—Ö —Å–µ—Ä–≤–∏—Å–æ–≤
docker-compose up --build

# 2. –¢–æ–ª—å–∫–æ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ + Redis
docker-compose up app redis

# 3. –° –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–æ–º
docker-compose -f docker-compose.yml -f docker-compose.grafana.yml up
```

## üì° API

### –û—Å–Ω–æ–≤–Ω—ã–µ —ç–Ω–¥–ø–æ–∏–Ω—Ç—ã:
- `GET /` - –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ —Å–µ—Ä–≤–∏—Å–µ
- `GET /health` - health check
- `GET /ready` - –ø—Ä–æ–≤–µ—Ä–∫–∞ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π
- `POST /check` - **–ø—Ä–æ–≤–µ—Ä–∫–∞ –Ω–∞ –º–æ—à–µ–Ω–Ω–∏—á–µ—Å—Ç–≤–æ**
- `GET /metrics` - Prometheus –º–µ—Ç—Ä–∏–∫–∏

### –ü—Ä–∏–º–µ—Ä –∑–∞–ø—Ä–æ—Å–∞:
```bash
curl -X POST "http://localhost:8000/check" \
  -H "Content-Type: application/json" \
  -d '{
    "birth_date": "15.01.1990",
    "phone_number": "+79161234567",
    "loans_history": [{
      "loan_amount": 10000.0,
      "loan_date": "15.01.2023",
      "is_closed": true
    }]
  }'
```

## üìä –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥

| –°–µ—Ä–≤–∏—Å | URL | –ü–æ—Ä—Ç |
|--------|-----|------|
| –ü—Ä–∏–ª–æ–∂–µ–Ω–∏–µ | http://localhost:8000 | 8000 |
| –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è | http://localhost:8000/docs | 8000 |
| Prometheus | http://localhost:9090 | 9090 |
| Grafana | http://localhost:3000 | 3000 |

**–õ–æ–≥–∏–Ω –≤ Grafana:** admin / admin123

## üß™ –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ

```bash
# –ó–∞–ø—É—Å–∫ —Ç–µ—Å—Ç–æ–≤
pytest tests/ -v

# –° –ø–æ–∫—Ä—ã—Ç–∏–µ–º –∫–æ–¥–∞
pytest --cov=app --cov-report=html tests/
```

## üìÅ –°—Ç—Ä—É–∫—Ç—É—Ä–∞

```
test_app/
‚îú‚îÄ‚îÄ app/                    # –ö–æ–¥ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è
‚îÇ   ‚îú‚îÄ‚îÄ main.py            # FastAPI –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ
‚îÇ   ‚îú‚îÄ‚îÄ logic.py           # –ë–∏–∑–Ω–µ—Å-–ª–æ–≥–∏–∫–∞ –ø—Ä–æ–≤–µ—Ä–æ–∫
‚îÇ   ‚îú‚îÄ‚îÄ redis_client.py    # Redis –∫—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ
‚îÇ   ‚îî‚îÄ‚îÄ schemas.py         # Pydantic —Å—Ö–µ–º—ã
‚îú‚îÄ‚îÄ tests/                 # –¢–µ—Å—Ç—ã
‚îú‚îÄ‚îÄ docker-compose.yml     # Docker –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è
‚îú‚îÄ‚îÄ Dockerfile            # –û–±—Ä–∞–∑ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è
‚îî‚îÄ‚îÄ pyproject.toml        # –ó–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏
```

## üîß –ë–∏–∑–Ω–µ—Å-–ª–æ–≥–∏–∫–∞

–ü—Ä–æ–≤–µ—Ä—è–µ—Ç:
1. **–¢–µ–ª–µ—Ñ–æ–Ω** - –Ω–∞—á–∏–Ω–∞–µ—Ç—Å—è —Å +7 –∏–ª–∏ 8
2. **–í–æ–∑—Ä–∞—Å—Ç** - —Å—Ç–∞—Ä—à–µ 18 –ª–µ—Ç
3. **–ó–∞–π–º—ã** - –Ω–µ—Ç –∞–∫—Ç–∏–≤–Ω—ã—Ö (–Ω–µ –∑–∞–∫—Ä—ã—Ç—ã—Ö) –∑–∞–π–º–æ–≤

**–†–µ–∑—É–ª—å—Ç–∞—Ç—ã –∫—ç—à–∏—Ä—É—é—Ç—Å—è –≤ Redis –Ω–∞ 1 —á–∞—Å.**

## üõ†Ô∏è –ó–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏

–£—Å—Ç–∞–Ω–æ–≤–∫–∞:
```bash
pip install -e .
```

–û—Å–Ω–æ–≤–Ω—ã–µ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏:
- FastAPI, Pydantic, Redis
- Prometheus-client, Uvicorn
- Pytest (–¥–ª—è —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏)

## üìù –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è

–°–∫–æ–ø–∏—Ä—É–π—Ç–µ `.env.example` –≤ `.env`:
```env
REDIS_HOST=redis
REDIS_PORT=6379
APP_PORT=8000
LOG_LEVEL=INFO
```

---

**–ü—Ä–æ–µ–∫—Ç –≥–æ—Ç–æ–≤ –∫ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—é!** –ó–∞–ø—É—Å–∫–∞–π—Ç–µ, —Ç–µ—Å—Ç–∏—Ä—É–π—Ç–µ, –º–æ–Ω–∏—Ç–æ—Ä—å—Ç–µ. üöÄ